<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SQLAlchemy + MySQL + pandas ì €ì¥ ê°•ì˜ì•ˆ (ì¢…í•©ë³¸: .env + book_id ì¤‘ë³µ ë°©ì§€)</title>
  <link rel="stylesheet" href="styles.css" />
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Apple SD Gothic Neo,Noto Sans KR,sans-serif; line-height:1.65; margin:0;}
    .container{max-width:1040px; margin:0 auto; padding:24px;}
    .header{padding:28px 0; border-bottom:1px solid #e7e7e7;}
    .badge{display:inline-block; font-size:12px; padding:4px 10px; border:1px solid #ddd; border-radius:999px;}
    .title{margin:10px 0 6px; font-size:30px;}
    .subtitle{margin:0; color:#555;}
    .section{margin:34px 0;}
    .card{border:1px solid #e7e7e7; border-radius:16px; padding:18px; background:#fff;}
    pre{margin:0; overflow:auto; padding:14px; background:#0b1020; color:#e9ecff; border-radius:12px;}
    code{font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace;}
    .grid-2{display:grid; grid-template-columns:1fr; gap:14px;}
    @media (min-width: 980px){ .grid-2{grid-template-columns:1fr 1fr;} }
    .list{margin:10px 0 0 18px;}
    .note{margin-top:10px; color:#444;}
    .warn{margin-top:10px; padding:14px 16px; border-radius:12px; background:#fff7e6; border:1px solid #ffd28a;}
    .ok{margin-top:10px; padding:14px 16px; border-radius:12px; background:#eafff1; border:1px solid #88e5ad;}
    .mini{font-size:13px; color:#555;}
    .hr{border:0; border-top:1px solid #e7e7e7; margin:22px 0;}
    .kbd{display:inline-block; padding:0 7px; border-radius:8px; border:1px solid #e7e7e7; background:#fafafa; font-size:12px;}
    .tag{display:inline-block; margin-right:6px; padding:2px 10px; border-radius:999px; border:1px solid #e7e7e7; background:#fafafa; font-size:12px;}
    blockquote{margin:12px 0 0; padding:12px 14px; border-left:4px solid #e7e7e7; background:#fafafa; border-radius:10px;}
  </style>
</head>

<body>
<header class="header">
  <div class="container">
    <span class="badge">pandas Â· SQLAlchemy Â· PyMySQL Â· MySQL Â· python-dotenv Â· to_sql Â· ALTER TABLE Â· upsert</span>
    <h1 class="title">SQLAlchemyë¡œ MySQL ì €ì¥í•˜ê¸° â€” ì¢…í•©ë³¸<br><strong>.env + book_id ì¤‘ë³µ ë°©ì§€</strong></h1>
    <p class="subtitle">
      â€œì£¼ì–´ì§„ ì½”ë“œâ€ë¥¼ ì¶œë°œì ìœ¼ë¡œ<br>
      â‘  SQLAlchemy ê¸°ì´ˆ(Engine/Connection) â‘¡ .env ì ìš© â‘¢ pandas to_sql ì €ì¥<br>
      â‘£ <strong>book_id ê¸°ì¤€ ì¤‘ë³µ ë°©ì§€(append â†’ ALTER TABLE â†’ upsert)</strong>ê¹Œì§€ í•œ ë²ˆì— ì •ë¦¬í•©ë‹ˆë‹¤.
    </p>
  </div>
</header>

<main class="container">

<section class="section">
  <h2>0ï¸âƒ£ ì˜¤ëŠ˜ ëª©í‘œ(ìµœì¢… ê²°ê³¼)</h2>
  <div class="card">
    <ul class="list">
      <li><strong>ì½”ë“œ ì„¤ëª…</strong>: db_connect / load_data / to_dbê°€ ì™œ ì´ëŸ° êµ¬ì¡°ì¸ì§€ ì´í•´</li>
      <li><strong>ë³´ì•ˆ</strong>: ID/PWë¥¼ ì½”ë“œì— ì“°ì§€ ì•Šê³  <strong>.env</strong>ë¡œ ë¶„ë¦¬</li>
      <li><strong>ì €ì¥</strong>: DataFrameì„ MySQLì— <strong>append</strong>ë¡œ ì €ì¥</li>
      <li><strong>ì¤‘ë³µ ë°©ì§€</strong>: <code>book_id</code>ë¥¼ ê¸°ì¤€ìœ¼ë¡œ <strong>DBì—ì„œ UNIQUE/PK</strong>ë¥¼ ê±¸ê³  upsertë¡œ ê°±ì‹ </li>
    </ul>
    <div class="ok">
      í•µì‹¬ ë¬¸ì¥: <strong>to_sqlì€ ì œì•½ì¡°ê±´ì„ ëª» ê±´ë‹¤ â†’ appendë¡œ ì ì¬ â†’ ALTER TABLEë¡œ UNIQUE/PK â†’ ê·¸ ë‹¤ìŒ upsert</strong>
    </div>
  </div>
</section>

<section class="section">
  <h2>1ï¸âƒ£ ì¤€ë¹„ë¬¼ ì„¤ì¹˜</h2>
  <div class="card">
<pre><code>pip install pandas sqlalchemy pymysql python-dotenv</code></pre>
    <p class="note mini">
      MySQL ì„œë²„ëŠ” ë³„ë„ë¡œ ì‹¤í–‰ ì¤‘ì´ì–´ì•¼ í•©ë‹ˆë‹¤. (ë¡œì»¬ ì„¤ì¹˜ / Docker ëª¨ë‘ ê°€ëŠ¥)
    </p>
  </div>
</section>

<section class="section">
  <h2>2ï¸âƒ£ .env ì¤€ë¹„ (ID/PWëŠ” ì½”ë“œì— ì“°ì§€ ì•Šê¸°)</h2>
  <div class="card">
    <p class="note">í”„ë¡œì íŠ¸ ë£¨íŠ¸ì— <code>.env</code> íŒŒì¼ì„ ë§Œë“¤ê³  ì•„ë˜ì²˜ëŸ¼ ì‘ì„±í•©ë‹ˆë‹¤.</p>
<pre><code># .env
MYSQL_HOST=localhost
MYSQL_PORT=3306
MYSQL_USER=root
MYSQL_PASSWORD=1234</code></pre>

    <div class="warn">
      <strong>.envëŠ” Gitì— ì˜¬ë¦¬ë©´ ì•ˆ ë©ë‹ˆë‹¤.</strong><br>
      <code>.gitignore</code>ì— ë°˜ë“œì‹œ ì¶”ê°€í•˜ì„¸ìš”.
    </div>
<pre><code># .gitignore
.env</code></pre>
  </div>
</section>

<section class="section">
  <h2>3ï¸âƒ£ SQLAlchemy í•µì‹¬ ê°œë…: Engine vs Connection</h2>
  <div class="card">
    <ul class="list">
      <li><strong>Engine</strong>: DB ì ‘ì† ì •ë³´(ì£¼ì†Œ/ê³„ì •/ë“œë¼ì´ë²„)ë¥¼ ë‹´ì€ â€œì„¤ì • ê°ì²´â€</li>
      <li><strong>Connection</strong>: Engineìœ¼ë¡œë¶€í„° ì–»ëŠ” â€œì‹¤ì œ ì—°ê²° í†µë¡œâ€</li>
    </ul>
    <div class="ok">
      íŒ¨í„´: <strong>ì—”ì§„ ìƒì„± â†’ ì—°ê²° ì—´ê¸° â†’ ì‘ì—… â†’ ì—°ê²° ë‹«ê¸°</strong>
    </div>
    <p class="note mini">
      SQL ì‹¤í–‰ì€ ë¬¸ìì—´ ê·¸ëŒ€ë¡œë³´ë‹¤ <code>text()</code>ë¡œ ê°ì‹¸ëŠ” ê²ƒì´ ì•ˆì „í•˜ê³  ì¼ë°˜ì ì¸ íŒ¨í„´ì…ë‹ˆë‹¤.
    </p>
  </div>
</section>

<section class="section">
  <h2>4ï¸âƒ£ ì£¼ì–´ì§„ ì½”ë“œ(ì›ë³¸) â€” ë¬´ì—‡ì„ í•˜ëŠ” ì½”ë“œì¸ê°€?</h2>
  <div class="card">
<pre><code>import pandas as pd
import os
from datetime import datetime
from sqlalchemy import create_engine, text
import pymysql
pymysql.install_as_MySQLdb()


def db_connect(dbname):
    engine_root = create_engine(f"mysql+pymysql://root:1234@localhost:3306")
    with engine_root.connect() as conn:
        conn.execute(text(f"create database if not exists {dbname}"))
        print(f"{dbname} ë°ì´í„°ë² ì´ìŠ¤ í™•ì¸/ìƒì„± ì™„ë£Œ")

    engine = create_engine(f"mysql+pymysql://root:1234@localhost:3306/{dbname}")
    conn = engine.connect()
    return conn


def load_data(dbname, table_name):
    conn = db_connect(dbname)
    data = pd.read_sql(table_name, con=conn)
    conn.close()
    return data        

def to_db(dbname, table_name, df):
    conn = db_connect(dbname)
    df.to_sql(table_name, con=conn, index=False, if_exists="append")
    conn.close()
    return print(f"{dbname}.{table_name} ë°ì´í„° ì €ì¥ ì™„ë£Œ")</code></pre>

    <hr class="hr" />

    <h3>4-1) db_connect(dbname) ì„¤ëª…</h3>
    <ul class="list">
      <li><span class="tag">1ë‹¨ê³„</span> DB ì—†ì´ ì„œë²„ì— ì ‘ì†(<code>...@host:port</code>)í•´ì„œ <strong>DB ì¡´ì¬ í™•ì¸/ìƒì„±</strong></li>
      <li><span class="tag">2ë‹¨ê³„</span> DB ì´ë¦„ì„ ë¶™ì—¬ ë‹¤ì‹œ ì ‘ì†(<code>...@host:port/dbname</code>)í•˜ê³  ì—°ê²°ì„ ë°˜í™˜</li>
    </ul>

    <h3>4-2) load_data(dbname, table_name) ì„¤ëª…</h3>
    <ul class="list">
      <li><code>pd.read_sql</code>ë¡œ í…Œì´ë¸” ì „ì²´ë¥¼ DataFrameìœ¼ë¡œ ì½ìŒ</li>
      <li>ì‘ì—… í›„ ë°˜ë“œì‹œ <code>conn.close()</code>ë¡œ ì—°ê²° ë‹«ìŒ</li>
    </ul>

    <h3>4-3) to_db(dbname, table_name, df) ì„¤ëª…</h3>
    <ul class="list">
      <li><code>df.to_sql(..., if_exists="append")</code>ë¡œ <strong>í–‰ì„ ì¶”ê°€ ì €ì¥</strong></li>
      <li>ì´ ë°©ì‹ì€ â€œì¤‘ë³µ ê²€ì‚¬â€ ì—†ì´ ê·¸ëƒ¥ ì¶”ê°€í•˜ë¯€ë¡œ ì¤‘ë³µì´ ìƒê¸¸ ìˆ˜ ìˆìŒ</li>
    </ul>
  </div>
</section>

<section class="section">
  <h2>5ï¸âƒ£ ì›ë³¸ ì½”ë“œë¥¼ .env ë²„ì „ìœ¼ë¡œ ìˆ˜ì •(ê¶Œì¥)</h2>
  <div class="card">
    <p class="note">
      ì›ë³¸ ì½”ë“œëŠ” <code>root:1234</code>ê°€ ì½”ë“œì— ë°•í˜€ ìˆì–´ ë³´ì•ˆ/ê´€ë¦¬ ì¸¡ë©´ì—ì„œ ë¶ˆë¦¬í•©ë‹ˆë‹¤.<br>
      ì•„ë˜ì²˜ëŸ¼ <strong>.envì—ì„œ ì½ë„ë¡</strong> ë°”ê¾¸ëŠ” ê²ƒì„ ê°•ë ¥ ì¶”ì²œí•©ë‹ˆë‹¤.
    </p>

<pre><code>import pandas as pd
import os
from sqlalchemy import create_engine, text
import pymysql
from dotenv import load_dotenv

pymysql.install_as_MySQLdb()
load_dotenv()

MYSQL_HOST = os.getenv("MYSQL_HOST", "localhost")
MYSQL_PORT = os.getenv("MYSQL_PORT", "3306")
MYSQL_USER = os.getenv("MYSQL_USER", "root")
MYSQL_PASSWORD = os.getenv("MYSQL_PASSWORD", "")

def _mysql_url(dbname=None):
    if dbname:
        return f"mysql+pymysql://{MYSQL_USER}:{MYSQL_PASSWORD}@{MYSQL_HOST}:{MYSQL_PORT}/{dbname}"
    return f"mysql+pymysql://{MYSQL_USER}:{MYSQL_PASSWORD}@{MYSQL_HOST}:{MYSQL_PORT}"

def db_connect(dbname):
    engine_root = create_engine(_mysql_url())
    with engine_root.connect() as conn:
        conn.execute(text(f"create database if not exists {dbname}"))
        print(f"{dbname} ë°ì´í„°ë² ì´ìŠ¤ í™•ì¸/ìƒì„± ì™„ë£Œ")

    engine = create_engine(_mysql_url(dbname))
    conn = engine.connect()
    return conn

def load_data(dbname, table_name):
    conn = db_connect(dbname)
    data = pd.read_sql(table_name, con=conn)
    conn.close()
    return data

def to_db_append(dbname, table_name, df):
    conn = db_connect(dbname)
    df.to_sql(table_name, con=conn, index=False, if_exists="append")
    conn.close()
    print(f"{dbname}.{table_name} ë°ì´í„° ì €ì¥ ì™„ë£Œ(append)")</code></pre>

  </div>
</section>

<section class="section">
  <h2>6ï¸âƒ£ ì¤‘ë³µ ë°©ì§€ì˜ í•µì‹¬: book_idë¥¼ ê³ ìœ í‚¤ë¡œ ì¡ëŠ”ë‹¤</h2>
  <div class="card">
<pre><code># YES24 ìƒì„¸ ë§í¬ì—ì„œ book_id ì¶”ì¶œ
a_title = item.select_one(".gd_name")
book_id = a_title["href"].split("/")[-1] if a_title else None</code></pre>

    <p class="note">
      <strong>book_id</strong>ëŠ” YES24 ìƒí’ˆì„ êµ¬ë¶„í•˜ëŠ” ê³ ìœ  ê°’ì´ë¯€ë¡œ
      <strong>ì¤‘ë³µ ë°©ì§€ ê¸°ì¤€ í‚¤</strong>ë¡œ ê°€ì¥ ì í•©í•©ë‹ˆë‹¤.
    </p>
  </div>
</section>

<section class="section">
  <h2>7ï¸âƒ£ ì¤‘ìš”í•œ ì‚¬ì‹¤: to_sql()ë¡œëŠ” UNIQUE/PKë¥¼ ê±¸ ìˆ˜ ì—†ë‹¤</h2>
  <div class="card">
    <p class="note">
      <code>DataFrame.to_sql()</code>ì€ â€œë°ì´í„°ë¥¼ ë„£ëŠ” ê¸°ëŠ¥â€ë§Œ í•©ë‹ˆë‹¤.<br>
      PRIMARY KEY / UNIQUE ê°™ì€ <strong>ì œì•½ì¡°ê±´ì„ ì„¤ì •í•˜ëŠ” ì˜µì…˜ì´ ì—†ìŠµë‹ˆë‹¤</strong>.
    </p>
    <div class="warn">
      ê·¸ë˜ì„œ ì¤‘ë³µ ë°©ì§€ëŠ” ë°˜ë“œì‹œ ì•„ë˜ ìˆœì„œë¡œ í•©ë‹ˆë‹¤.<br>
      <strong>appendë¡œ ì ì¬ â†’ ALTER TABLEë¡œ UNIQUE/PK ì„¤ì • â†’ ê·¸ ì´í›„ upsert</strong>
    </div>
  </div>
</section>

<section class="section">
  <h2>8ï¸âƒ£ (Step 1) ì²˜ìŒì—ëŠ” appendë¡œ ì €ì¥</h2>
  <div class="card">
<pre><code># ì´ˆê¸° ì ì¬(ì¤‘ë³µì´ ìƒê²¨ë„ â€œì •ìƒâ€ì¸ ë‹¨ê³„)
to_db_append("yes24_db", "books", df)</code></pre>

    <div class="warn">
      ì´ ë‹¨ê³„ì—ì„œëŠ” ì¤‘ë³µ ë°©ì§€ë¥¼ â€œì‹œì‘í•˜ì§€ ì•Šì•˜ë‹¤â€.<br>
      ë”°ë¼ì„œ <strong>ì¤‘ë³µì´ ìƒê¸¸ ìˆ˜ ìˆë‹¤</strong>.
    </div>
  </div>
</section>

<section class="section">
  <h2>9ï¸âƒ£ (Step 2 Â· ì„ íƒ) ë°°ì¹˜ ë‚´ë¶€ ì¤‘ë³µ ì œê±°</h2>
  <div class="card">
<pre><code># ê°™ì€ ì‹¤í–‰(batch) ì•ˆì—ì„œë§Œ ì¤‘ë³µ ì œê±°
df = df.drop_duplicates(subset=["book_id"], keep="last")</code></pre>
    <p class="note mini">
      ì´ê±´ â€œì €ì¥ ì „ì— ê¹”ë”í•˜ê²Œ ì •ë¦¬â€í•˜ëŠ” ë³´ì¡° ìˆ˜ë‹¨ì…ë‹ˆë‹¤.<br>
      DBì— ì´ë¯¸ ë“¤ì–´ìˆëŠ” ì¤‘ë³µê¹Œì§€ ì™„ë²½íˆ ì²˜ë¦¬í•˜ë ¤ë©´ DB ì œì•½ì¡°ê±´ì´ í•„ìš”í•©ë‹ˆë‹¤.
    </p>
  </div>
</section>

<section class="section">
  <h2>ğŸ”Ÿ (Step 3) ALTER TABLEë¡œ book_idì— UNIQUE/PK ì¶”ê°€</h2>
  <div class="card">
    <p class="note">
      ì´ˆê¸° ì ì¬ê°€ ëë‚¬ë‹¤ë©´ ì´ì œ DBì—ì„œ ì¤‘ë³µì„ ì›ì²œ ì°¨ë‹¨í•©ë‹ˆë‹¤.
    </p>

<pre><code>-- book_idë¥¼ UNIQUEë¡œ ë§Œë“¤ê¸°(ì¶”ì²œ)
ALTER TABLE books
ADD UNIQUE KEY uk_book_id (book_id);</code></pre>

<pre><code>-- ë˜ëŠ” book_idë¥¼ PRIMARY KEYë¡œ ë§Œë“¤ê¸°
ALTER TABLE books
ADD PRIMARY KEY (book_id);</code></pre>

    <div class="ok">
      ì´ ì‹œì ë¶€í„° DBëŠ” ê°™ì€ book_idê°€ ë‹¤ì‹œ ë“¤ì–´ì˜¤ë©´ â€œì¤‘ë³µâ€ìœ¼ë¡œ íŒë‹¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    </div>

    <div class="warn">
      âš ï¸ ì´ë¯¸ ì¤‘ë³µ ë°ì´í„°ê°€ ë“¤ì–´ìˆìœ¼ë©´ UNIQUE/PK ì¶”ê°€ê°€ ì‹¤íŒ¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br>
      ê·¸ ê²½ìš° ë¨¼ì € ì¤‘ë³µì„ ì •ë¦¬í•´ì•¼ í•©ë‹ˆë‹¤.
    </div>

<pre><code>-- ì¤‘ë³µ í™•ì¸(ì˜ˆì‹œ)
SELECT book_id, COUNT(*)
FROM books
GROUP BY book_id
HAVING COUNT(*) &gt; 1;</code></pre>

  </div>
</section>

<section class="section">
  <h2>1ï¸âƒ£1ï¸âƒ£ (Step 4) upsertë¡œ â€œì¤‘ë³µì´ë©´ ì—…ë°ì´íŠ¸â€ ì €ì¥</h2>
  <div class="card">
    <p class="note">
      MySQLì€ <code>INSERT ... ON DUPLICATE KEY UPDATE</code>ë¡œ upsertë¥¼ ì§€ì›í•©ë‹ˆë‹¤.<br>
      ë‹¨, <strong>UNIQUE/PKê°€ ë¨¼ì € ì„¤ì •ë˜ì–´ ìˆì–´ì•¼</strong> duplicate keyë¥¼ ê°ì§€í•©ë‹ˆë‹¤.
    </p>

<pre><code>def to_db_upsert_mysql(dbname, table_name, df):
    """MySQL ì „ìš© upsert (PK/UNIQUE í•„ìš”)
    - ê¸°ì¤€ ê³ ìœ í‚¤: book_id
    """
    conn = db_connect(dbname)

    cols = list(df.columns)
    col_list = ", ".join([f"`{c}`" for c in cols])
    placeholders = ", ".join(["%s"] * len(cols))

    # book_idëŠ” ë³´í†µ ì—…ë°ì´íŠ¸ ì œì™¸
    update_cols = [c for c in cols if c != "book_id"]
    update_expr = ", ".join([f"`{c}`=VALUES(`{c}`)" for c in update_cols])

    sql = f"""INSERT INTO `{table_name}` ({col_list})
    VALUES ({placeholders})
    ON DUPLICATE KEY UPDATE {update_expr}"""

    rows = [tuple(x) for x in df.itertuples(index=False, name=None)]

    conn.execute(text(sql), rows)
    conn.commit()
    conn.close()

    print(f"{dbname}.{table_name} book_id ê¸°ì¤€ upsert ì €ì¥ ì™„ë£Œ")</code></pre>

    <div class="ok">
      ì´ì œë¶€í„°ëŠ” ê°™ì€ book_idë¡œ ë‹¤ì‹œ ìˆ˜ì§‘ë˜ì–´ë„ ì¤‘ë³µ ì €ì¥ì´ ì•„ë‹ˆë¼ â€œê°±ì‹ â€ë©ë‹ˆë‹¤.
    </div>
  </div>
</section>

<section class="section">
  <h2>1ï¸âƒ£2ï¸âƒ£ ì‹¤ìŠµ ì˜ˆì œ: 1) appendë¡œ ë„£ê³  2) UNIQUE ê±¸ê³  3) upsertë¡œ ê°±ì‹ </h2>
  <div class="card">
<pre><code>import pandas as pd
from datetime import datetime

# ì˜ˆì‹œ ë°ì´í„°: book_idê°€ ê°™ì€ í–‰ì´ 2ê°œ(ì¤‘ë³µ ìƒí™©)
df = pd.DataFrame([
    {"book_id": 111, "title": "ì±…A", "publisher": "ì¶œíŒì‚¬1", "updated_at": datetime.now()},
    {"book_id": 111, "title": "ì±…A(ì œëª©ìˆ˜ì •)", "publisher": "ì¶œíŒì‚¬1", "updated_at": datetime.now()},
    {"book_id": 222, "title": "ì±…B", "publisher": "ì¶œíŒì‚¬2", "updated_at": datetime.now()},
])

# (ì„ íƒ) ë°°ì¹˜ ì¤‘ë³µ ì œê±°
df = df.drop_duplicates(subset=["book_id"], keep="last")

# 1) ì´ˆê¸° ì ì¬(append)
to_db_append("yes24_db", "books", df)

# 2) ê·¸ ë‹¤ìŒì— ì§ì ‘ SQLë¡œ UNIQUE/PKë¥¼ ê±¸ì–´ì•¼ í•¨(ì²˜ìŒ 1íšŒ)
#    ALTER TABLE books ADD UNIQUE KEY uk_book_id (book_id);

# 3) ì´í›„ë¶€í„°ëŠ” upsert ì‚¬ìš©
to_db_upsert_mysql("yes24_db", "books", df)

# í™•ì¸
print(load_data("yes24_db", "books"))</code></pre>

    <div class="warn">
      âš ï¸ ìœ„ ì˜ˆì œëŠ” â€œìˆœì„œâ€ë¥¼ ë³´ì—¬ì£¼ê¸° ìœ„í•œ ê²ƒì…ë‹ˆë‹¤.<br>
      ì‹¤ì œ ìš´ì˜ì—ì„œëŠ” <strong>ì´ˆê¸° ì ì¬ê°€ ëë‚œ ë’¤ì—ë§Œ</strong> ALTER TABLEì„ 1íšŒ ìˆ˜í–‰í•˜ê³ ,<br>
      ê·¸ ì´í›„ë¶€í„°ëŠ” upsertë§Œ ì‚¬ìš©í•˜ë©´ ë©ë‹ˆë‹¤.
    </div>
  </div>
</section>

<section class="section">
  <h2>1ï¸âƒ£3ï¸âƒ£ ì´ˆë³´ìê°€ ìì£¼ í•˜ëŠ” ì‹¤ìˆ˜ TOP 6</h2>
  <div class="card">
    <ol class="list">
      <li><strong>.env ë¡œë“œ ëˆ„ë½</strong>: <code>load_dotenv()</code>ë¥¼ ì•ˆ ì”€</li>
      <li><strong>ì—°ê²° ë¯¸ì¢…ë£Œ</strong>: ì‘ì—… í›„ <code>conn.close()</code>ë¥¼ ë¹¼ë¨¹ìŒ</li>
      <li><strong>to_sqlë¡œ UNIQUEë¥¼ ê±¸ë ¤ê³  í•¨</strong>: ë¶ˆê°€ëŠ¥(ALTER TABLEë¡œ í•´ì•¼ í•¨)</li>
      <li><strong>UNIQUE/PK ì—†ì´ upsertë¥¼ ê¸°ëŒ€</strong>: duplicate keyë¥¼ ê°ì§€ ëª»í•¨</li>
      <li><strong>ALTER TABLEì´ ì‹¤íŒ¨</strong>: ì´ë¯¸ ì¤‘ë³µ ë°ì´í„°ê°€ ë“¤ì–´ìˆìŒ</li>
      <li><strong>book_idê°€ ë¬¸ìì—´ì¸ë° BIGINTë¡œ ì„¤ê³„</strong>: íƒ€ì… ì„¤ê³„/ë³€í™˜ í•„ìš”</li>
    </ol>
  </div>
</section>

<footer class="section">
  <div class="card">
    <p class="mini">
      ì •ë¦¬: ì´ ê°•ì˜ì•ˆì˜ í•µì‹¬ì€ â€œë„êµ¬ ì—­í•  ë¶„ë¦¬â€ì…ë‹ˆë‹¤.<br>
      <strong>pandas(to_sql)=ì €ì¥</strong> / <strong>SQL(ALTER TABLE)=ì œì•½ì¡°ê±´</strong> / <strong>MySQL(upsert)=ì¤‘ë³µ ë°©ì§€</strong>
    </p>
  </div>
</footer>

</main>
</body>
</html>
