<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sakila SELECT 실습 50문제 (문제+정답)</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header class="header">
    <div class="container">
      <h1 class="title">Sakila SELECT 실습 50문제</h1>
      <p class="subtitle">SELECT 전체 문법 · EXP 유형 문법 포함 · 정답은 접기/펼치기 방식이다.</p>

      <nav class="toc">
        <a href="#guide">사용 방법</a>
        <a href="#part1">1) SELECT 기본</a>
        <a href="#part2">2) WHERE</a>
        <a href="#part3">3) LIKE</a>
        <a href="#part4">4) ORDER BY/LIMIT</a>
        <a href="#part5">5) DISTINCT/집계</a>
        <a href="#part6">6) GROUP BY/HAVING</a>
        <a href="#part7">7) JOIN/복합</a>
	<a href="#part8">8) 서브쿼리</a>
      </nav>
    </div>
  </header>

  <main class="container">

    <section id="guide" class="section">
      <h2>사용 방법</h2>
      <div class="card">
        <ol class="list">
          <li>각 문제를 읽고 먼저 스스로 SQL을 작성하는 것이 목표이다.</li>
          <li>작성 후 정답을 펼쳐 비교하는 방식이 효과적이다.</li>
          <li>Sakila 데이터베이스가 선택되어 있어야 실행되는 실습이다.</li>
        </ol>
        <div class="note">
          <p><strong>권장 방법</strong>은 “문제 풀이 → 실행 → 결과 확인 → 정답 비교” 순서로 진행하는 것이다.</p>
        </div>
      </div>
    </section>

    <!-- 공통: 문제 카드 -->
    <section id="part1" class="section">
      <h2>1) SELECT 기본 (1~5)</h2>

      <div class="card">
        <h3>1번</h3>
        <p>actor 테이블에 있는 모든 정보를 조회하시오.</p>
        <details>
          <summary>정답 SQL 보기</summary>
          <pre><code>SELECT *
FROM actor;</code></pre>
        </details>
      </div>

      <div class="card">
        <h3>2번</h3>
        <p>actor 테이블에서 배우의 이름(first_name)과 성(last_name)만 조회하시오.</p>
        <details>
          <summary>정답 SQL 보기</summary>
          <pre><code>SELECT first_name, last_name
FROM actor;</code></pre>
        </details>
      </div>

      <div class="card">
        <h3>3번</h3>
        <p>film 테이블에서 영화 제목(title)만 조회하시오.</p>
        <details>
          <summary>정답 SQL 보기</summary>
          <pre><code>SELECT title
FROM film;</code></pre>
        </details>
      </div>

      <div class="card">
        <h3>4번</h3>
        <p>customer 테이블에서 고객의 이름(first_name, last_name)과 이메일(email)을 조회하시오.</p>
        <details>
          <summary>정답 SQL 보기</summary>
          <pre><code>SELECT first_name, last_name, email
FROM customer;</code></pre>
        </details>
      </div>

      <div class="card">
        <h3>5번</h3>
        <p>payment 테이블의 모든 결제 정보를 조회하시오.</p>
        <details>
          <summary>정답 SQL 보기</summary>
          <pre><code>SELECT *
FROM payment;</code></pre>
        </details>
      </div>
    </section>

    <section id="part2" class="section">
      <h2>2) WHERE 조건 (6~12)</h2>

      <div class="card">
        <h3>6번</h3>
        <p>film 테이블에서 등급(rating)이 'PG'인 영화만 조회하시오.</p>
        <details>
          <summary>정답 SQL 보기</summary>
          <pre><code>SELECT *
FROM film
WHERE rating = 'PG';</code></pre>
        </details>
      </div>

      <div class="card">
        <h3>7번</h3>
        <p>film 테이블에서 대여 요금(rental_rate)이 3보다 큰 영화만 조회하시오.</p>
        <details>
          <summary>정답 SQL 보기</summary>
          <pre><code>SELECT title, rental_rate
FROM film
WHERE rental_rate &gt; 3;</code></pre>
        </details>
      </div>

      <div class="card">
        <h3>8번</h3>
        <p>film 테이블에서 대여 요금이 2 이상이고 등급이 'PG-13'인 영화를 조회하시오.</p>
        <details>
          <summary>정답 SQL 보기</summary>
          <pre><code>SELECT title, rental_rate, rating
FROM film
WHERE rental_rate &gt;= 2
  AND rating = 'PG-13';</code></pre>
        </details>
      </div>

      <div class="card">
        <h3>9번</h3>
        <p>film 테이블에서 등급이 'PG' 또는 'G'인 영화를 조회하시오.</p>
        <details>
          <summary>정답 SQL 보기</summary>
          <pre><code>SELECT title, rating
FROM film
WHERE rating = 'PG'
   OR rating = 'G';</code></pre>
        </details>
      </div>

      <div class="card">
        <h3>10번</h3>
        <p>film 테이블에서 대여 요금이 2 이상 4 이하인 영화를 조회하시오.</p>
        <details>
          <summary>정답 SQL 보기</summary>
          <pre><code>SELECT title, rental_rate
FROM film
WHERE rental_rate BETWEEN 2 AND 4;</code></pre>
        </details>
      </div>

      <div class="card">
        <h3>11번</h3>
        <p>film 테이블에서 등급이 'PG', 'G', 'PG-13' 중 하나인 영화를 조회하시오.</p>
        <details>
          <summary>정답 SQL 보기</summary>
          <pre><code>SELECT title, rating
FROM film
WHERE rating IN ('PG', 'G', 'PG-13');</code></pre>
        </details>
      </div>

      <div class="card">
        <h3>12번</h3>
        <p>customer 테이블에서 이메일이 없는 고객을 조회하시오.</p>
        <details>
          <summary>정답 SQL 보기</summary>
          <pre><code>SELECT *
FROM customer
WHERE email IS NULL;</code></pre>
        </details>
      </div>
    </section>

    <section id="part3" class="section">
      <h2>3) LIKE / 문자열 조건 (13~17)</h2>

      <div class="card">
        <h3>13번</h3>
        <p>film 테이블에서 제목에 'LOVE'가 포함된 영화를 조회하시오.</p>
        <details>
          <summary>정답 SQL 보기</summary>
          <pre><code>SELECT title
FROM film
WHERE title LIKE '%LOVE%';</code></pre>
        </details>
      </div>

      <div class="card">
        <h3>14번</h3>
        <p>film 테이블에서 제목이 'A'로 시작하는 영화를 조회하시오.</p>
        <details>
          <summary>정답 SQL 보기</summary>
          <pre><code>SELECT title
FROM film
WHERE title LIKE 'A%';</code></pre>
        </details>
      </div>

      <div class="card">
        <h3>15번</h3>
        <p>film 테이블에서 제목이 'MAN'으로 끝나는 영화를 조회하시오.</p>
        <details>
          <summary>정답 SQL 보기</summary>
          <pre><code>SELECT title
FROM film
WHERE title LIKE '%MAN';</code></pre>
        </details>
      </div>

      <div class="card">
        <h3>16번</h3>
        <p>customer 테이블에서 성(last_name)에 공백이 포함된 고객을 조회하시오.</p>
        <details>
          <summary>정답 SQL 보기</summary>
          <pre><code>SELECT *
FROM customer
WHERE last_name LIKE '% %';</code></pre>
        </details>
      </div>

      <div class="card">
        <h3>17번</h3>
        <p>actor 테이블에서 이름(first_name)에 'JO'가 포함된 배우를 조회하시오.</p>
        <details>
          <summary>정답 SQL 보기</summary>
          <pre><code>SELECT *
FROM actor
WHERE first_name LIKE '%JO%';</code></pre>
        </details>
      </div>
    </section>

    <section id="part4" class="section">
      <h2>4) ORDER BY / LIMIT (18~23)</h2>

      <div class="card">
        <h3>18번</h3>
        <p>film 테이블에서 대여 요금이 높은 순서대로 정렬하여 조회하시오.</p>
        <details>
          <summary>정답 SQL 보기</summary>
          <pre><code>SELECT title, rental_rate
FROM film
ORDER BY rental_rate DESC;</code></pre>
        </details>
      </div>

      <div class="card">
        <h3>19번</h3>
        <p>film 테이블에서 등급은 오름차순, 대여 요금은 내림차순으로 정렬하시오.</p>
        <details>
          <summary>정답 SQL 보기</summary>
          <pre><code>SELECT title, rating, rental_rate
FROM film
ORDER BY rating ASC, rental_rate DESC;</code></pre>
        </details>
      </div>

      <div class="card">
        <h3>20번</h3>
        <p>대여 요금이 가장 비싼 영화 5개만 조회하시오.</p>
        <details>
          <summary>정답 SQL 보기</summary>
          <pre><code>SELECT title, rental_rate
FROM film
ORDER BY rental_rate DESC
LIMIT 5;</code></pre>
        </details>
      </div>

      <div class="card">
        <h3>21번</h3>
        <p>actor 테이블에서 배우 10명만 조회하시오.</p>
        <details>
          <summary>정답 SQL 보기</summary>
          <pre><code>SELECT *
FROM actor
LIMIT 10;</code></pre>
        </details>
      </div>

      <div class="card">
        <h3>22번</h3>
        <p>customer 테이블에서 이름(first_name) 오름차순으로 정렬하여 20명만 조회하시오.</p>
        <details>
          <summary>정답 SQL 보기</summary>
          <pre><code>SELECT *
FROM customer
ORDER BY first_name ASC
LIMIT 20;</code></pre>
        </details>
      </div>

      <div class="card">
        <h3>23번</h3>
        <p>film 테이블에서 대여 요금이 낮은 영화 3개를 조회하시오.</p>
        <details>
          <summary>정답 SQL 보기</summary>
          <pre><code>SELECT title, rental_rate
FROM film
ORDER BY rental_rate ASC
LIMIT 3;</code></pre>
        </details>
      </div>
    </section>

    <section id="part5" class="section">
      <h2>5) DISTINCT / 집계 함수 (24~30)</h2>

      <div class="card">
        <h3>24번</h3>
        <p>film 테이블에 존재하는 등급 종류를 중복 없이 조회하시오.</p>
        <details>
          <summary>정답 SQL 보기</summary>
          <pre><code>SELECT DISTINCT rating
FROM film;</code></pre>
        </details>
      </div>

      <div class="card">
        <h3>25번</h3>
        <p>film 테이블의 영화 총 개수를 조회하시오.</p>
        <details>
          <summary>정답 SQL 보기</summary>
          <pre><code>SELECT COUNT(*) AS 영화수
FROM film;</code></pre>
        </details>
      </div>

      <div class="card">
        <h3>26번</h3>
        <p>film 테이블의 평균 대여 요금을 조회하시오.</p>
        <details>
          <summary>정답 SQL 보기</summary>
          <pre><code>SELECT AVG(rental_rate) AS 평균요금
FROM film;</code></pre>
        </details>
      </div>

      <div class="card">
        <h3>27번</h3>
        <p>film 테이블에서 가장 비싼 대여 요금을 조회하시오.</p>
        <details>
          <summary>정답 SQL 보기</summary>
          <pre><code>SELECT MAX(rental_rate) AS 최고요금
FROM film;</code></pre>
        </details>
      </div>

      <div class="card">
        <h3>28번</h3>
        <p>film 테이블에서 가장 저렴한 대여 요금을 조회하시오.</p>
        <details>
          <summary>정답 SQL 보기</summary>
          <pre><code>SELECT MIN(rental_rate) AS 최저요금
FROM film;</code></pre>
        </details>
      </div>

      <div class="card">
        <h3>29번</h3>
        <p>payment 테이블의 총 결제 금액을 조회하시오.</p>
        <details>
          <summary>정답 SQL 보기</summary>
          <pre><code>SELECT SUM(amount) AS 총결제금액
FROM payment;</code></pre>
        </details>
      </div>

      <div class="card">
        <h3>30번</h3>
        <p>payment 테이블에서 결제 금액(amount)의 평균을 조회하시오.</p>
        <details>
          <summary>정답 SQL 보기</summary>
          <pre><code>SELECT AVG(amount) AS 평균결제금액
FROM payment;</code></pre>
        </details>
      </div>
    </section>

    <section id="part6" class="section">
      <h2>6) GROUP BY / HAVING (31~38)</h2>

      <div class="card">
        <h3>31번</h3>
        <p>영화 등급(rating)별 영화 개수를 조회하시오.</p>
        <details>
          <summary>정답 SQL 보기</summary>
          <pre><code>SELECT rating, COUNT(*) AS 영화수
FROM film
GROUP BY rating;</code></pre>
        </details>
      </div>

      <div class="card">
        <h3>32번</h3>
        <p>영화 등급(rating)별 평균 대여 요금(rental_rate)을 조회하시오.</p>
        <details>
          <summary>정답 SQL 보기</summary>
          <pre><code>SELECT rating, AVG(rental_rate) AS 평균요금
FROM film
GROUP BY rating;</code></pre>
        </details>
      </div>

      <div class="card">
        <h3>33번</h3>
        <p>영화가 200편 이상인 등급만 조회하시오.</p>
        <details>
          <summary>정답 SQL 보기</summary>
          <pre><code>SELECT rating, COUNT(*) AS 영화수
FROM film
GROUP BY rating
HAVING COUNT(*) &gt;= 200;</code></pre>
        </details>
      </div>

      <div class="card">
        <h3>34번</h3>
        <p>직원(staff_id)별 총 결제 금액을 조회하시오.</p>
        <details>
          <summary>정답 SQL 보기</summary>
          <pre><code>SELECT staff_id, SUM(amount) AS 총결제금액
FROM payment
GROUP BY staff_id;</code></pre>
        </details>
      </div>

      <div class="card">
        <h3>35번</h3>
        <p>직원(staff_id)별 총 결제 금액이 5000 이상인 직원만 조회하시오.</p>
        <details>
          <summary>정답 SQL 보기</summary>
          <pre><code>SELECT staff_id, SUM(amount) AS 총결제금액
FROM payment
GROUP BY staff_id
HAVING SUM(amount) &gt;= 5000;</code></pre>
        </details>
      </div>

      <div class="card">
        <h3>36번</h3>
        <p>고객(customer_id)별 결제 횟수를 조회하시오.</p>
        <details>
          <summary>정답 SQL 보기</summary>
          <pre><code>SELECT customer_id, COUNT(*) AS 결제횟수
FROM payment
GROUP BY customer_id;</code></pre>
        </details>
      </div>

      <div class="card">
        <h3>37번</h3>
        <p>결제 횟수가 30회 이상인 고객만 조회하시오.</p>
        <details>
          <summary>정답 SQL 보기</summary>
          <pre><code>SELECT customer_id, COUNT(*) AS 결제횟수
FROM payment
GROUP BY customer_id
HAVING COUNT(*) &gt;= 30;</code></pre>
        </details>
      </div>

      <div class="card">
        <h3>38번</h3>
        <p>고객(customer_id)별 총 결제 금액을 계산하시오.</p>
        <details>
          <summary>정답 SQL 보기</summary>
          <pre><code>SELECT customer_id, SUM(amount) AS 총결제금액
FROM payment
GROUP BY customer_id;</code></pre>
        </details>
      </div>
    </section>

    <section id="part7" class="section">
      <h2>7) JOIN + 실무형 복합 (39~50)</h2>

      <div class="card">
        <h3>39번</h3>
        <p>고객 이름과 대여 날짜(rental_date)를 함께 조회하시오.</p>
        <details>
          <summary>정답 SQL 보기</summary>
          <pre><code>SELECT c.first_name, c.last_name, r.rental_date
FROM customer c
JOIN rental r
ON c.customer_id = r.customer_id;</code></pre>
        </details>
      </div>

      <div class="card">
        <h3>40번</h3>
        <p>고객별 대여 횟수를 조회하시오.</p>
        <details>
          <summary>정답 SQL 보기</summary>
          <pre><code>SELECT c.customer_id, COUNT(r.rental_id) AS 대여횟수
FROM customer c
LEFT JOIN rental r
ON c.customer_id = r.customer_id
GROUP BY c.customer_id;</code></pre>
        </details>
      </div>

      <div class="card">
        <h3>41번</h3>
        <p>대여 횟수가 20회 이상인 고객만 조회하시오.</p>
        <details>
          <summary>정답 SQL 보기</summary>
          <pre><code>SELECT c.customer_id, COUNT(r.rental_id) AS 대여횟수
FROM customer c
LEFT JOIN rental r
ON c.customer_id = r.customer_id
GROUP BY c.customer_id
HAVING COUNT(r.rental_id) &gt;= 20;</code></pre>
        </details>
      </div>

      <div class="card">
        <h3>42번</h3>
        <p>고객 이름과 총 결제 금액을 함께 조회하시오.</p>
        <details>
          <summary>정답 SQL 보기</summary>
          <pre><code>SELECT c.first_name, c.last_name, SUM(p.amount) AS 총결제금액
FROM customer c
JOIN payment p
ON c.customer_id = p.customer_id
GROUP BY c.customer_id;</code></pre>
        </details>
      </div>

      <div class="card">
        <h3>43번</h3>
        <p>총 결제 금액이 100 이상인 고객만 조회하시오.</p>
        <details>
          <summary>정답 SQL 보기</summary>
          <pre><code>SELECT c.customer_id, SUM(p.amount) AS 총결제금액
FROM customer c
JOIN payment p
ON c.customer_id = p.customer_id
GROUP BY c.customer_id
HAVING SUM(p.amount) &gt;= 100;</code></pre>
        </details>
      </div>

      <div class="card">
        <h3>44번</h3>
        <p>가장 많은 결제 금액을 낸 고객 5명을 조회하시오.</p>
        <details>
          <summary>정답 SQL 보기</summary>
          <pre><code>SELECT c.customer_id, SUM(p.amount) AS 총결제금액
FROM customer c
JOIN payment p
ON c.customer_id = p.customer_id
GROUP BY c.customer_id
ORDER BY 총결제금액 DESC
LIMIT 5;</code></pre>
        </details>
      </div>

      <div class="card">
        <h3>45번</h3>
        <p>대여 기록이 없는 고객도 모두 포함하여 조회하시오.</p>
        <details>
          <summary>정답 SQL 보기</summary>
          <pre><code>SELECT c.customer_id, r.rental_id
FROM customer c
LEFT JOIN rental r
ON c.customer_id = r.customer_id;</code></pre>
        </details>
      </div>

      <div class="card">
        <h3>46번</h3>
        <p>대여 기록이 없는 고객만 조회하시오.</p>
        <details>
          <summary>정답 SQL 보기</summary>
          <pre><code>SELECT c.customer_id
FROM customer c
LEFT JOIN rental r
ON c.customer_id = r.customer_id
WHERE r.rental_id IS NULL;</code></pre>
        </details>
      </div>

      <div class="card">
        <h3>47번</h3>
        <p>결제 금액이 1 미만이거나 NULL인 데이터를 조회하시오.</p>
        <details>
          <summary>정답 SQL 보기</summary>
          <pre><code>SELECT *
FROM payment
WHERE amount &lt; 1
   OR amount IS NULL;</code></pre>
        </details>
      </div>

      <div class="card">
        <h3>48번</h3>
        <p>고객별 대여 횟수와 총 결제 금액을 함께 조회하시오.</p>
        <details>
          <summary>정답 SQL 보기</summary>
          <pre><code>SELECT c.customer_id,
       COUNT(r.rental_id) AS 대여횟수,
       SUM(p.amount) AS 총결제금액
FROM customer c
LEFT JOIN rental r ON c.customer_id = r.customer_id
LEFT JOIN payment p ON r.rental_id = p.rental_id
GROUP BY c.customer_id;</code></pre>
        </details>
      </div>

      <div class="card">
        <h3>49번</h3>
        <p>대여 횟수가 10회 이상이고 총 결제 금액이 50 이상인 고객을 조회하시오.</p>
        <details>
          <summary>정답 SQL 보기</summary>
          <pre><code>SELECT c.customer_id,
       COUNT(r.rental_id) AS 대여횟수,
       SUM(p.amount) AS 총결제금액
FROM customer c
LEFT JOIN rental r ON c.customer_id = r.customer_id
LEFT JOIN payment p ON r.rental_id = p.rental_id
GROUP BY c.customer_id
HAVING COUNT(r.rental_id) &gt;= 10
   AND SUM(p.amount) &gt;= 50;</code></pre>
        </details>
      </div>

      <div class="card">
        <h3>50번</h3>
        <p>대여 횟수 내림차순, 총 결제 금액 내림차순으로 정렬하여 상위 10명을 조회하시오.</p>
        <details>
          <summary>정답 SQL 보기</summary>
          <pre><code>SELECT c.customer_id,
       COUNT(r.rental_id) AS 대여횟수,
       SUM(p.amount) AS 총결제금액
FROM customer c
LEFT JOIN rental r ON c.customer_id = r.customer_id
LEFT JOIN payment p ON r.rental_id = p.rental_id
GROUP BY c.customer_id
ORDER BY 대여횟수 DESC, 총결제금액 DESC
LIMIT 10;</code></pre>
        </details>
      </div>

    </section>

<!-- ===============================
     서브쿼리 연습문제 (51 ~ 70)
     =============================== -->
<selction id="part8" class="section">
 <h2>8) 서브쿼리 연습문제 (51 ~ 70)</h2>
<div class="card">
  <h3>51번</h3>
  <p>film 테이블에서 대여요금이 가장 비싼 영화의 제목과 대여요금을 조회하시오.</p>
  <details>
    <summary>정답 SQL 보기</summary>
    <pre><code>SELECT title, rental_rate
FROM film
WHERE rental_rate = (
  SELECT MAX(rental_rate)
  FROM film
);</code></pre>
  </details>
</div>

<div class="card">
  <h3>52번</h3>
  <p>film 테이블에서 전체 영화의 평균 대여요금보다 비싼 영화의 제목과 대여요금을 조회하시오.</p>
  <details>
    <summary>정답 SQL 보기</summary>
    <pre><code>SELECT title, rental_rate
FROM film
WHERE rental_rate &gt; (
  SELECT AVG(rental_rate)
  FROM film
);</code></pre>
  </details>
</div>

<div class="card">
  <h3>53번</h3>
  <p>'Comedy' 장르에 속한 영화의 제목을 조회하시오.</p>
  <details>
    <summary>정답 SQL 보기</summary>
    <pre><code>SELECT f.title
FROM film f
WHERE f.film_id IN (
  SELECT fc.film_id
  FROM film_category fc
  WHERE fc.category_id = (
    SELECT category_id
    FROM category
    WHERE name = 'Comedy'
  )
);</code></pre>
  </details>
</div>

<div class="card">
  <h3>54번</h3>
  <p>'Comedy' 또는 'Action' 장르에 속한 영화의 제목을 조회하시오.</p>
  <details>
    <summary>정답 SQL 보기</summary>
    <pre><code>SELECT f.title
FROM film f
WHERE f.film_id IN (
  SELECT fc.film_id
  FROM film_category fc
  WHERE fc.category_id IN (
    SELECT category_id
    FROM category
    WHERE name IN ('Comedy', 'Action')
  )
);</code></pre>
  </details>
</div>

<div class="card">
  <h3>55번</h3>
  <p>payment 테이블에서 가장 결제 금액이 큰 결제의 customer_id와 amount를 조회하시오.</p>
  <details>
    <summary>정답 SQL 보기</summary>
    <pre><code>SELECT customer_id, amount
FROM payment
WHERE amount = (
  SELECT MAX(amount)
  FROM payment
);</code></pre>
  </details>
</div>

<div class="card">
  <h3>56번</h3>
  <p>payment 테이블에서 전체 평균 결제 금액보다 큰 결제를 조회하시오.</p>
  <details>
    <summary>정답 SQL 보기</summary>
    <pre><code>SELECT payment_id, customer_id, amount
FROM payment
WHERE amount &gt; (
  SELECT AVG(amount)
  FROM payment
);</code></pre>
  </details>
</div>

<div class="card">
  <h3>57번</h3>
  <p>결제 기록이 한 번도 없는 고객의 이름을 조회하시오.</p>
  <details>
    <summary>정답 SQL 보기</summary>
    <pre><code>SELECT c.first_name, c.last_name
FROM customer c
WHERE NOT EXISTS (
  SELECT 1
  FROM payment p
  WHERE p.customer_id = c.customer_id
);</code></pre>
  </details>
</div>

<div class="card">
  <h3>58번</h3>
  <p>대여 기록이 한 번도 없는 고객의 이름을 조회하시오.</p>
  <details>
    <summary>정답 SQL 보기</summary>
    <pre><code>SELECT c.first_name, c.last_name
FROM customer c
WHERE NOT EXISTS (
  SELECT 1
  FROM rental r
  WHERE r.customer_id = c.customer_id
);</code></pre>
  </details>
</div>

<div class="card">
  <h3>59번</h3>
  <p>각 고객의 평균 결제 금액보다 큰 결제 내역을 조회하시오.</p>
  <details>
    <summary>정답 SQL 보기</summary>
    <pre><code>SELECT p.payment_id, p.customer_id, p.amount
FROM payment p
WHERE p.amount &gt; (
  SELECT AVG(p2.amount)
  FROM payment p2
  WHERE p2.customer_id = p.customer_id
);</code></pre>
  </details>
</div>

<div class="card">
  <h3>60번</h3>
  <p>각 고객의 총 결제 금액을 고객 이름 옆에 함께 조회하시오.</p>
  <details>
    <summary>정답 SQL 보기</summary>
    <pre><code>SELECT
  c.first_name,
  c.last_name,
  (
    SELECT SUM(p.amount)
    FROM payment p
    WHERE p.customer_id = c.customer_id
  ) AS total_payment
FROM customer c
ORDER BY total_payment DESC;</code></pre>
  </details>
</div>

<div class="card">
  <h3>61번</h3>
  <p>영화별 대여 횟수가 전체 평균 대여 횟수보다 많은 영화 제목을 조회하시오.</p>
  <details>
    <summary>정답 SQL 보기</summary>
    <pre><code>SELECT f.title
FROM film f
WHERE (
  SELECT COUNT(*)
  FROM inventory i
  JOIN rental r ON r.inventory_id = i.inventory_id
  WHERE i.film_id = f.film_id
) &gt; (
  SELECT AVG(cnt)
  FROM (
    SELECT i2.film_id, COUNT(*) AS cnt
    FROM inventory i2
    JOIN rental r2 ON r2.inventory_id = i2.inventory_id
    GROUP BY i2.film_id
  ) t
);</code></pre>
  </details>
</div>

<div class="card">
  <h3>62번</h3>
  <p>'Comedy' 장르 영화들의 대여요금 중 ANY보다 큰 영화의 제목을 조회하시오.</p>
  <details>
    <summary>정답 SQL 보기</summary>
    <pre><code>SELECT title, rental_rate
FROM film
WHERE rental_rate &gt; ANY (
  SELECT f2.rental_rate
  FROM film f2
  WHERE f2.film_id IN (
    SELECT fc.film_id
    FROM film_category fc
    WHERE fc.category_id = (
      SELECT category_id FROM category WHERE name = 'Comedy'
    )
  )
);</code></pre>
  </details>
</div>

<div class="card">
  <h3>63번</h3>
  <p>'Comedy' 장르 영화들의 대여요금보다 모두 큰 영화의 제목을 조회하시오.</p>
  <details>
    <summary>정답 SQL 보기</summary>
    <pre><code>SELECT title, rental_rate
FROM film
WHERE rental_rate &gt; ALL (
  SELECT f2.rental_rate
  FROM film f2
  WHERE f2.film_id IN (
    SELECT fc.film_id
    FROM film_category fc
    WHERE fc.category_id = (
      SELECT category_id FROM category WHERE name = 'Comedy'
    )
  )
);</code></pre>
  </details>
</div>

<div class="card">
  <h3>64번</h3>
  <p>가장 많은 대여 횟수를 가진 고객의 customer_id와 대여 횟수를 조회하시오.</p>
  <details>
    <summary>정답 SQL 보기</summary>
    <pre><code>SELECT customer_id, COUNT(*) AS rental_cnt
FROM rental
GROUP BY customer_id
HAVING COUNT(*) = (
  SELECT MAX(cnt)
  FROM (
    SELECT COUNT(*) AS cnt
    FROM rental
    GROUP BY customer_id
  ) t
);</code></pre>
  </details>
</div>

<div class="card">
  <h3>65번</h3>
  <p>가장 많이 대여된 영화의 제목을 조회하시오.</p>
  <details>
    <summary>정답 SQL 보기</summary>
    <pre><code>SELECT f.title
FROM film f
WHERE f.film_id = (
  SELECT i.film_id
  FROM inventory i
  JOIN rental r ON r.inventory_id = i.inventory_id
  GROUP BY i.film_id
  ORDER BY COUNT(*) DESC
  LIMIT 1
);</code></pre>
  </details>
</div>

<div class="card">
  <h3>66번</h3>
  <p>매장(store) 1에만 존재하는 영화의 제목을 조회하시오.</p>
  <details>
    <summary>정답 SQL 보기</summary>
    <pre><code>SELECT f.title
FROM film f
WHERE EXISTS (
  SELECT 1 FROM inventory i
  WHERE i.film_id = f.film_id AND i.store_id = 1
)
AND NOT EXISTS (
  SELECT 1 FROM inventory i
  WHERE i.film_id = f.film_id AND i.store_id = 2
);</code></pre>
  </details>
</div>

<div class="card">
  <h3>67번</h3>
  <p>배우 'PENELOPE GUINESS'가 출연한 영화 제목을 조회하시오.</p>
  <details>
    <summary>정답 SQL 보기</summary>
    <pre><code>SELECT f.title
FROM film f
WHERE f.film_id IN (
  SELECT fa.film_id
  FROM film_actor fa
  WHERE fa.actor_id = (
    SELECT actor_id
    FROM actor
    WHERE first_name = 'PENELOPE'
      AND last_name = 'GUINESS'
  )
);</code></pre>
  </details>
</div>

<div class="card">
  <h3>68번</h3>
  <p>출연 배우 수가 전체 평균보다 많은 영화의 제목을 조회하시오.</p>
  <details>
    <summary>정답 SQL 보기</summary>
    <pre><code>SELECT f.title
FROM film f
WHERE (
  SELECT COUNT(*)
  FROM film_actor fa
  WHERE fa.film_id = f.film_id
) &gt; (
  SELECT AVG(actor_cnt)
  FROM (
    SELECT film_id, COUNT(*) AS actor_cnt
    FROM film_actor
    GROUP BY film_id
  ) t
);</code></pre>
  </details>
</div>

<div class="card">
  <h3>69번</h3>
  <p>결제 총액이 상위 10명인 고객의 이름과 총 결제 금액을 조회하시오.</p>
  <details>
    <summary>정답 SQL 보기</summary>
    <pre><code>SELECT
  c.first_name,
  c.last_name,
  (
    SELECT SUM(p.amount)
    FROM payment p
    WHERE p.customer_id = c.customer_id
  ) AS total_payment
FROM customer c
ORDER BY total_payment DESC
LIMIT 10;</code></pre>
  </details>
</div>

<div class="card">
  <h3>70번</h3>
  <p>대여는 했지만 결제 기록이 없는 대여 내역을 조회하시오.</p>
  <details>
    <summary>정답 SQL 보기</summary>
    <pre><code>SELECT r.rental_id, r.customer_id, r.rental_date
FROM rental r
WHERE NOT EXISTS (
  SELECT 1
  FROM payment p
  WHERE p.rental_id = r.rental_id
);</code></pre>
  </details>
</div>

<section>

  </main>

  <footer class="footer">
    <div class="container">
      <p>© Sakila SELECT Practice. 학습 목적으로 제작된 실습 문제집이다.</p>
    </div>
  </footer>
</body>
</html>
